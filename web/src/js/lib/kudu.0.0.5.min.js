!function(e,r,t){r[e]=r[e]||t(),"undefined"!=typeof module&&module.exports?module.exports=r[e]:"function"==typeof define&&define.amd&&define("utils/jqr/npo",[],function(){return r[e]})}("Promise","undefined"!=typeof global?global:this,function(){"use strict";function e(e,r){v.add(e,r),f||(f=p(v.drain))}function r(e){var r,t=typeof e;return null==e||"object"!=t&&"function"!=t||(r=e.then),"function"==typeof r?r:!1}function t(){for(var e=0;e<this.chain.length;e++)n(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function n(e,t,n){var o,i;try{t===!1?n.reject(e.msg):(o=t===!0?e.msg:t.call(void 0,e.msg),o===n.promise?n.reject(TypeError("Promise-chain cycle")):(i=r(o))?i.call(o,n.resolve,n.reject):n.resolve(o))}catch(u){n.reject(u)}}function o(n){var u,s=this;if(!s.triggered){s.triggered=!0,s.def&&(s=s.def);try{(u=r(n))?e(function(){var e=new a(s);try{u.call(n,function(){o.apply(e,arguments)},function(){i.apply(e,arguments)})}catch(r){i.call(e,r)}}):(s.msg=n,s.state=1,s.chain.length>0&&e(t,s))}catch(c){i.call(new a(s),c)}}}function i(r){var n=this;n.triggered||(n.triggered=!0,n.def&&(n=n.def),n.msg=r,n.state=2,n.chain.length>0&&e(t,n))}function u(e,r,t,n){for(var o=0;o<r.length;o++)!function(o){e.resolve(r[o]).then(function(e){t(o,e)},n)}(o)}function a(e){this.def=e,this.triggered=!1}function s(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function c(r){if("function"!=typeof r)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var n=new s(this);this.then=function(r,o){var i={success:"function"==typeof r?r:!0,failure:"function"==typeof o?o:!1};return i.promise=new this.constructor(function(e,r){if("function"!=typeof e||"function"!=typeof r)throw TypeError("Not a function");i.resolve=e,i.reject=r}),n.chain.push(i),0!==n.state&&e(t,n),i.promise},this["catch"]=function(e){return this.then(void 0,e)};try{r.call(void 0,function(e){o.call(n,e)},function(e){i.call(n,e)})}catch(u){i.call(n,u)}}var l,f,v,d=Object.prototype.toString,p="undefined"!=typeof setImmediate?function(e){return setImmediate(e)}:setTimeout;try{Object.defineProperty({},"x",{}),l=function(e,r,t,n){return Object.defineProperty(e,r,{value:t,writable:!0,configurable:n!==!1})}}catch(h){l=function(e,r,t){return e[r]=t,e}}v=function(){function e(e,r){this.fn=e,this.self=r,this.next=void 0}var r,t,n;return{add:function(o,i){n=new e(o,i),t?t.next=n:r=n,t=n,n=void 0},drain:function(){var e=r;for(r=t=f=void 0;e;)e.fn.call(e.self),e=e.next}}}();var m=l({},"constructor",c,!1);return c.prototype=m,l(m,"__NPO__",0,!1),l(c,"resolve",function(e){var r=this;return e&&"object"==typeof e&&1===e.__NPO__?e:new r(function(r,t){if("function"!=typeof r||"function"!=typeof t)throw TypeError("Not a function");r(e)})}),l(c,"reject",function(e){return new this(function(r,t){if("function"!=typeof r||"function"!=typeof t)throw TypeError("Not a function");t(e)})}),l(c,"all",function(e){var r=this;return"[object Array]"!=d.call(e)?r.reject(TypeError("Not an array")):0===e.length?r.resolve([]):new r(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");var o=e.length,i=Array(o),a=0;u(r,e,function(e,r){i[e]=r,++a===o&&t(i)},n)})}),l(c,"race",function(e){var r=this;return"[object Array]"!=d.call(e)?r.reject(TypeError("Not an array")):new r(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");u(r,e,function(e,r){t(r)},n)})}),c}),define("utils/mode",["require"],function(e){var r={DEBUG:null};return r}),define("utils/severity",["require"],function(e){function r(){this.DEBUG=0,this.INFO=1,this.WARN=2,this.ERROR=3}return new r}),define("utils/utils",["require","./jqr/npo","./mode","./severity"],function(e){function r(e){var r=window.console||{},t=r[e]||r.log||function(){},n=!1;try{n=!!t.apply}catch(o){}return n?function(){return t.apply(r,arguments)}:function(e,r){return t(e,null==r?"":r)}}function t(e){function r(e){switch(e.severity){case o.DEBUG:return i.log;case o.WARN:return i.warn;case o.INFO:return i.info;default:return i.error}}var t={},u=new Promise(function(e,r){e()});return t.noopPromise=function(){return u},t.isPromise=function(e){return null==e?!1:"function"==typeof e.then?!0:!1},t.isRactiveObject=function(e){return"object"==typeof e&&null!==e&&null!=e._guid?!0:!1},t.objectLength=function(e){if(Object.keys)return Object.keys(e).length;var r,t=0;for(r in e)e.hasOwnProperty(r)&&t++},t.isObject=function(e){return"object"==typeof e&&null!==e?!0:!1},t.populateError=function(e,r,n){(e instanceof Error||t.isObject(e))&&(null==e.options&&(e.options=n),null==e.severity&&(e.severity=r))},t.logError=function(e){if(null!=e&&n.DEBUG){var i=t.isObject(e);i&&null==e.severity&&(e.severity=o.ERROR);var u=r(e);if(u(e.stack?e.stack:e),i)for(var a in e)u(a,":",e[a])}},t}e("./jqr/npo");var n=e("./mode"),o=e("./severity"),i={log:r("log"),warn:r("warn"),info:r("info"),error:r("error")},t=t();return t}),define("utils/jqr/jqutils",["require","./npo"],function(e){function r(e){function r(e){return Object.prototype.toString.call(e).replace(/^\[object (.+)\]$/,"$1").toLowerCase()}function t(e,n,i,u){var a;if(Array.isArray(n))n.forEach(function(r,n){i||o.test(e)?u(e,r):t(e+"["+("object"==typeof r?n:"")+"]",r,i,u)});else if(i||"object"!==r(n))u(e,n);else for(a in n)t(e+"["+a+"]",n[a],i,u)}var n={},o=/\[\]$/,i=/%20/g;return n.isFunction=function(e){return"function"==typeof e},n.fadeIn=function(e){e.style.opacity=0;var r=+new Date,t=function(){e.style.opacity=+e.style.opacity+(new Date-r)/400,r=+new Date,+e.style.opacity<1&&(window.requestAnimationFrame&&requestAnimationFrame(t)||setTimeout(t,16))};t()},n.fadeOut=function(e){e.style.opacity=0;var r=+new Date,t=function(){e.style.opacity=+e.style.opacity+(new Date-r)/400,r=+new Date,+e.style.opacity<1&&(window.requestAnimationFrame&&requestAnimationFrame(t)||setTimeout(t,16))};t()},n.extend=function(e){e=e||{};for(var r=1;r<arguments.length;r++)if(arguments[r])for(var t in arguments[r])arguments[r].hasOwnProperty(t)&&(e[t]=arguments[r][t]);return e},n.param=function(e,r){var n,o=[],u=function(e,r){r="function"==typeof r?r():null==r?"":r,o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(r)};if(Array.isArray(e))e.forEach(function(e,r){u(e.name,e.value)});else for(n in e)t(n,e[n],r,u);return o.join("&").replace(i,"+")},n}e("./npo");var r=r();return r}),define("router/router",["require","../utils/jqr/npo","../utils/utils","../utils/severity","../utils/jqr/jqutils"],function(e){"use strict";function r(r){var t=new Promise(function(r,o){var i=window.location.href.indexOf("#");if(-1===i||i===location.href.length-1){if(null==a)throw new Error("Couldn't resolve the url, "+location.href+", to a route. Please set the option 'kudu.defaultRoute' to render a default page!");return r(a),t}var u=x.urlPath(window.location.href);u=n(u),e([u],function(e){if(null==e)return void o();var t={path:u,ctrl:e,moduleId:u};r(t)},function(e){o(e)})});return t}function t(e,r){if(null!=r){var t=!0,n=v.param(r,t);n.length>0&&(e=-1===e.indexOf("?")?e+"?"+n:e+"&"+n)}return e}function n(e){return"string"==typeof e&&0===e.indexOf("/")?e.slice(1):e}function o(e){c!=e&&(y=!0)}function i(e,r){return e.length>0&&"/"!==e&&(e+="/"),0==r.length&&(r="/"),e+=r}e("../utils/jqr/npo");var u,a,s,c,l,f=e("../utils/utils"),v=(e("../utils/severity"),e("../utils/jqr/jqutils")),d={},p={},h={},m={statechange:[],routeload:[]},w=[],g={},y=!1,R="",E=function(){if(R!=window.location.href){if(R=window.location.href,x.getHash()===c)return;l=c,c=x.getHash(),x.fire("statechange")}},x={init:function(e){return l=c,c=x.getHash(),"undefined"==typeof e&&(e={}),x.addRoutes(e.routes),u=e.unknownRouteResolver||r,a=e.defaultRoute||null,window.addEventListener?(window.addEventListener("popstate",E,!1),window.addEventListener("hashchange",E,!1)):(window.attachEvent("popstate",E),window.attachEvent("onhashchange",E)),e.loadCurrentRouteOnStateChange!==!1&&x.on("statechange",function(){if(y)return void(y=!1);var e={};x.loadCurrentRoute(e)}),e.fireInitialStateChange!==!1&&x.fire("statechange"),x},activeRoute:{},addRoutes:function(e){for(var r in e)e.hasOwnProperty(r)&&x.addRoute(e[r]);return x},addRoute:function(e){if(w.push(e),null==e.moduleId){if(null==e.ctrl)throw new Error("route must have a ctrl or moduleId defined!");e.moduleId=e.ctrl._kudu_id}return x.addRouteById(e),x},addRouteAt:function(e,r){return w.splice(e,0,r),x.addRouteById(r),x},addRouteById:function(e){"*"===e.path&&(s=e),void 0===g[e.moduleId]&&(g[e.moduleId]=[]),g[e.moduleId].push(e.path)},getRoutes:function(){return w},getRoutesById:function(){return g},on:function(e,r){return"undefined"==typeof m[e]&&(m[e]=[]),m[e].push(r),x},fire:function(e){if(m[e])for(var r=Array.prototype.slice.call(arguments,1),t=0;t<m[e].length;t++)m[e][t].apply(x,r);return x},off:function(e,r){if(m[e]){var t=m[e].indexOf(r);-1!==t&&m[e].splice(t,1)}return x},restorePreviousHash:function(){null!=l&&(c=l,o(c),x.setHash(c))},go:function(e){var r,n=e.ctrl;if(null==n&&e.route&&(n=e.route.ctrl,r=e.route.moduleId),null==n)throw new Error("router.go() requires a 'ctrl' passed as an option !");if(null==r&&(r=n._kudu_id),e.args=e.args||{},e.routeParams=e.routeParams||{},e.updateUrl===!1){var u={};u.moduleId=r,u.ctrl=n,e.route=u;var a=x.hashPath(c);return a=t(a,e.routeParams),o(a),x.setHash(a),void x.loadModule(e)}for(var l=null,f=x.findRoutesForCtrl(n),v=0;v<f.length;v++){var d=f[v],p=x.testCtrlRoute(d.path,e.routeParams);if(p){l=d;break}}if(null==l){console.error("No route matched request to Controller '"+n._kudu_id+"'! Available routes for this controller: ");for(var v=0;v<f.length;v++){var h=f[v];console.error("    ",h.path)}if(console.error("RouteParams used to match available Controller routes:",e.routeParams),!e.force)return e.route=s,null==e.route&&(e.route={}),void x.loadModule(e);console.error("options.force is true: will attempt to load the controller from moduleId: '"+r+"'")}var m=null!=l?l.path:r;if(m instanceof RegExp)throw new Error("Cannot route to controller '"+n._kudu_id+"' since it's route path is a RegExp '"+m+"'");if(-1!==m.indexOf("*"))throw new Error("Cannot route to controller '"+n._kudu_id+"' since it's route path contains wildcards '*'. The given route for the controller is '"+m+"'");var w={};if(-1!==m.indexOf("?")){var g=x.queryString(m);g.length>0&&(w=x.parseRouteQueryParams(g)),m=m.substr(0,m.indexOf("?"))}var y="",R=e.routeParams,E=m.split("/");for(var q in E)if(E.hasOwnProperty(q)){var j=E[q];if(":"===j.charAt(0)){var O=j.substr(1),P=R[O];if(null==P||""===P)throw new Error("Cannot route to controller '"+n._kudu_id+"' since it's route requires the path parameter '"+O+"' but the only params provided are '"+JSON.stringify(R)+"'");y=i(y,P),delete R[O]}else y=i(y,j)}for(var b in w)if(w.hasOwnProperty(b)){if(null==R)throw new Error("Cannot route to controller '"+n._kudu_id+"' since it's route requires the query parameter '"+b+"' but no routeParams was provided");var P=R[b];if(void 0===P)throw new Error("Cannot route to controller '"+n._kudu_id+"' since it's route requires the query parameter '"+b+"' but the only routeParams provided are '"+JSON.stringify(R)+"'")}y=t(y,R),o(y),x.setHash(y),x.loadCurrentRoute(e)},setHash:function(e){window.location.hash=e},getHash:function(){var e=window.location.href.indexOf("#"),r=-1==e?"":window.location.href.substr(e+1);return 0==r.indexOf("!")&&(r=r.substr(1)),r},findRoutesForCtrl:function(e){for(var r=[],t=e._kudu_id,n=0;n<w.length;n++){var o=w[n];null==t||null==o.moduleId?e===o.ctrl&&r.push(o):t===o.moduleId&&r.push(o)}return r},testCtrlRoute:function(e,r){e=n(e);var t=x.parseRouteParams(e);for(var o in t)if(t.hasOwnProperty(o)){if(!r.hasOwnProperty(o))return!1;var i=t[o];if(i.segment===!0){var u=r[o];if(null==u||""==u)return!1}}return!0},loadCurrentRoute:function(e){e=e||{};for(var r=null,t=0;t<w.length;t++){var n=w[t];if(e.route=n,x.testRoute(e)){r=n;break}}return null==r||"*"===r.path?(e.route=r,x.handleUnknownRoute(e),x):(null!=r&&(e.route=r,x.loadModule(e)),x)},handleUnknownRoute:function(e){var r=u(e.route);return f.isPromise(r)?r.then(function(r){e.route=r,x.loadUnknownRoute(e)})["catch"](function(r){null!=e.route&&x.loadModule(e)}):(e.route=r,x.loadUnknownRoute(e)),x},loadUnknownRoute:function(e){if(e=e||{},null!=e.route){if(null==e.route.moduleId||null==e.route.path)throw new Error("unknownRouteResolver must return a route object with a valid moduleId and path or a promise that resolves to a route object!");var r=x.getRoutesById()[e.route.moduleId];null==r?(e.route.isNew=!0,x.loadModule(e)):x.go(e)}return x},loadModule:function(r){r=r||{};var t=r.route;null==t.ctrl?e([t.moduleId],function(e){null!=e&&x.processLoadedModule(r,e,t)},function(){}):x.processLoadedModule(r,t.ctrl,t)},urlPath:function(e){if("undefined"!=typeof d[e])return d[e];var r=e.split("/"),t="/"+r.splice(3,r.length-3).join("/"),n=t.split(/[\?#]/)[0],o=t.indexOf("#"),i=o===t.length-1;if(-1!==o&&!i){var u=t.substring(o).split("?")[0];n="#!"===u.substring(0,2)?u.substring(2):u.substring(1)}return d[e]=n,n},processLoadedModule:function(e,r,t){if(x.activeRoute.active=!1,t.active=!0,x.activeRoute=t,t.isNew&&(delete t.isNew,x.addRouteAt(0,t)),t.active){var n=e.urlParams;null==n&&(n=x.routeArguments(t,window.location.href),e.urlParams=n);var o=v.extend({},e);o.routeParams=n,o.module=r,o.route=t,x.fire("routeload",o)}},testRoute:function(e){var r=x.urlPath(e.url||window.location.href);r=n(r);var t=e.route.path;if(t=n(t),t===r)return!0;if("*"===t)return!0;if(t instanceof RegExp)return t.test(r);if(-1===t.indexOf("*")&&-1===t.indexOf(":")&&-1===t.indexOf("?"))return!1;var o=r.split("/"),i=t.indexOf("?");-1!==i&&i!==t.length-1&&(t=t.substr(0,i));var u=t.split("/");if(o.length!==u.length)return!1;for(var a in u)if(u.hasOwnProperty(a)){var s=u[a],c=o[a];if("*"===s||":"===s.charAt(0)){if(null==c||""===c)return!1}else if(s!==c)return!1}if(-1!==i){var l=e.route.path;l=n(l);var f=l.substr(i+1),v=x.parseRouteQueryParams(f);if(null==e.urlParams){var d=x.routeArguments(e.route,window.location.href);e.urlParams=d}for(var a in v)if(v.hasOwnProperty(a)){var p=e.urlParams[a];if(null==p)return!1}}return!0},routeArguments:function(e,r){e||(e=x.activeRoute),r||(r=window.location.href);var t={},o=x.urlPath(r);o=n(o);var i=o.split("/"),u=[];if(e&&e.path&&!(e.path instanceof RegExp)){var a=e.path;a=n(a),u=a.split("/")}for(var s in u)if(u.hasOwnProperty(s)){var c=u[s];if(":"===c.charAt(0)){c=c.substring(1);var l=c.indexOf("?");-1!==l&&(c=c.substr(0,l)),t[c]=i[s]}}var f=x.queryString(r),v=x.queryParamsFromSearchString(f);for(var d in v)v.hasOwnProperty(d)&&(t[d]=v[d]);return t=x.parseArguments(t)},queryString:function(e){var r=e.indexOf("?"),t="";if(-1!==r){t=e.substring(r+1);var n=t.indexOf("#");-1!==n&&(t=t.substring(0,n))}var o=e.indexOf("#"),i=e.indexOf("#!");if(-1!==o||-1!==i){var u="";u=-1!==o?e.substring(o):e.substring(i),r=u.indexOf("?"),-1!==r&&(t=u.substring(r+1))}return t},queryParams:function(e){var r=x.queryString(e),t=x.queryParamsFromSearchString(r);return t},queryParamsFromSearchString:function(e){var r={},t=e.split("&");1===t.length&&""===t[0]&&(t=[]);for(var n in t)if(t.hasOwnProperty(n)){var o=t[n],i=o.split("="),u=i.splice(1,i.length-1).join("=");r[i[0]]=u}return r},parseArguments:function(e){for(var r in e){var t=e[r];"true"===t?e[r]=!0:"false"===t?e[r]=!1:isNaN(t)||""===t||"0"===t.charAt(0)?e[r]=decodeURIComponent(t):e[r]=+t}return e},parseRouteQueryParams:function(e){var r=h[e];if(null!=r)return r;var t={},n=e.split("&");1===n.length&&""===n[0]&&(n=[]);for(var o in n)if(n.hasOwnProperty(o)){var i=n[o];t[i]={query:!0}}return h[e]=t,t},parseRouteParams:function(e){var r=p[e];if(null!=r)return r;var t=e,n={};if(null==t||""==t)return n;if(t instanceof RegExp&&(t=t.toString(),t=t.substring(1,t.length-1)),-1===t.indexOf(":")&&-1!==t.indexOf("?"))return p[e]=n,n;var o=t.indexOf("?");-1!==o&&o!==t.length-1&&(t=t.substr(0,o));var i=t.split("/");for(var u in i)if(i.hasOwnProperty(u)){var a=i[u];if(":"===a.charAt(0)){var s=a.slice(1);n[s]={segment:!0}}}if(-1!==o){var c=e.substr(o+1),l=x.parseRouteQueryParams(c);n=v.extend(n,l)}return p[e]=n,n},hashPath:function(e){0===e.indexOf("#")&&(e=e.substring(1));var r=e.indexOf("?");return r>=0&&(e=e.substring(0,r)),e}};return x}),define("utils/at/xhrWrapper",["require"],function(e){function r(){var e={};return e.isXhr=function(e){return null!=e&&"function"==typeof e.getAllResponseHeaders&&"function"==typeof e.abort&&null==e.then?!0:!1},e.canWrap=function(r){return e.isXhr(r)},e.wrap=function(e){var r,t,n,o,i,u=new Promise(function(u,a){function s(){r=e.status,t=e.statusText,o=e.responseText}function c(){n=t,(r||!t)&&(t="error",0>r&&(r=0))}function l(){if(s(),i=r>=200&&300>r||304===r,i?204===r?t="nocontent":304===r?t="notmodified":(t="success",o=e.responseText):c(),"error"===t){var l={data:o,status:t,xhr:e,error:n};a(l)}else{var l={data:o,status:t,xhr:e,error:n};u(l)}}function f(){s(),c();var r={data:o,status:t,xhr:e,error:n};a(r)}function v(){f()}e.addEventListener("load",l),e.addEventListener("error",f),e.addEventListener("abort",v),null!=e.upload&&(e.upload.addEventListener("load",l),e.upload.addEventListener("error",f),e.upload.addEventListener("abort",v))});return u.abort=function(){e.abort()},u},e}return r()}),define("utils/at/jqxhrWrapper",["require","./xhrWrapper"],function(e){function r(){function e(e){return null!=e&&"function"==typeof e.getAllResponseHeaders&&"function"==typeof e.abort?!0:!1}var r={};return r.canWrap=function(r){return e(r)&&"function"==typeof r.then?!0:!1},r.wrap=function(e){var r=new Promise(function(r,t){e.then(function(e,t,n){r({data:e,status:t,xhr:n})},function(e,r,n){t({error:n,status:r,xhr:e})}),e.then(r,t)});return r.abort=function(){e.abort()},r},r}e("./xhrWrapper");return r()}),define("utils/at/deferredPromiseWrapper",["require","../utils"],function(e){function r(){function e(e){return null!=e&&"function"==typeof e.pipe&&"function"==typeof e.promise&&"function"==typeof e.state?!0:!1}var r={};return r.canWrap=function(r){return e(r)&&"function"==typeof r.then?!0:!1},r.wrap=function(e){var r=new Promise(function(r,t){e.then(function(e){r(e)},function(e){t(e)}),e.then(r,t)});return r.abort=function(){e.abort()},r},r}e("../utils");return r()}),define("utils/at/ajaxTracker",["require","../jqr/npo","./jqxhrWrapper","./xhrWrapper","./deferredPromiseWrapper","../jqr/jqutils"],function(e){function r(e){function r(e){var r=e.slice();r.forEach(function(e,r){e.promise.abort()}),v=null}function u(r,t,n,o){function i(t,i){t=t||{};var u;if(a(t.xhr))u=i===!0?{data:t.data,status:t.status,xhr:t.xhr,error:null,args:o}:{data:null,status:t.status,xhr:t.xhr,error:t.error,args:o};else{var c;arguments.length>0&&(c=Array.prototype.slice.call(arguments)),u={data:t,status:t.status,xhr:t.xhr,error:t.error,args:o,promiseArgs:c}}e.kudu.emit("ajax.complete",u);s.remove(r,n)}n.then(function(r){r=r||{};var t;if(a(r.xhr))t={data:r.data,status:r.status,xhr:r.xhr,args:o};else{var n;arguments.length>0&&(n=Array.prototype.slice.call(arguments)),t={data:r,status:null,xhr:null,error:null,args:o,promiseArgs:n}}e.kudu.emit("ajax.success",t)})["catch"](function(r){r=r||{};var t;if(a(r.xhr))t={error:r.error,status:r.status,xhr:r.xhr,args:o};else{var n;arguments.length>0&&(n=Array.prototype.slice.call(arguments)),t={data:null,status:null,xhr:null,error:r,args:o,promiseArgs:n}}e.kudu.emit("ajax.error",t)}),n.then(function(e){e=e||{},i(e,!0)})["catch"](function(e){e=e||{},i(e,!1)}),t.then(function(r){r=r||{};var n;if(a(r.xhr))n={data:r.data,status:r.status,xhr:r.xhr,args:o};else{var i;arguments.length>0&&(i=Array.prototype.slice.call(arguments)),n={data:r,status:null,xhr:null,error:null,args:o,promiseArgs:i}}null==v||v==t?(e.kudu.emit("ajax.stop",n),delete n.args,e.kudu.emit("global.ajax.stop",n),v=null):e.kudu.emit("ajax.stop",n)})["catch"](function(r){r=r||{};var n;if(a(r.xhr))n={error:r.error,status:r.status,xhr:r.xhr,args:o};else{var i;arguments.length>0&&(i=Array.prototype.slice.call(arguments)),n={data:null,status:null,xhr:null,error:r,args:o,promiseArgs:i}}return null!=v&&v!=t?void e.kudu.emit("ajax.stop",n):(e.kudu.emit("ajax.stop",n),delete n.args,e.kudu.emit("global.ajax.stop",n),v=null,void 0)})}function a(e){return null!=e&&"function"==typeof e.getAllResponseHeaders&&"function"==typeof e.abort?!0:!1}if(null==e.kudu)throw new Error("ajaxTracker requires an options.kudu instance!");var s={},c=0,l=0,f={},v=null,d={xhr:n,jqxhr:t,deferredPromise:o};return d=i.extend(d,e.wrappers),s.add=function(r,t,n){if("function"!=typeof t.abort)throw new Error("ajaxTracker.add(promiseOrXhr) requires an 'abort' function for when views are cancelled!");var o;o=null==t.then||null==t["catch"]?s.promisify(t):t;var i=f[r];null==i&&(i=[],f[r]=i);var a={promise:o,args:n};i.push(a);var d={xhr:o,args:n};return null==v?(v=Promise.all([o]),e.kudu.emit("global.ajax.start",d),d.args=n,e.kudu.emit("ajax.start",d)):(v=Promise.all([v,o]),d.args=n,e.kudu.emit("ajax.start",d)),v._id=c++,u(r,v,o,n),l++,v},s.remove=function(e,r){var t=f[e];if(null==t)return!1;for(var n=-1,o=0;o<t.length;o++){var i=t[o];if(i.promise===r){n=o;break}}return n>=0?(t.splice(n,1),0===t.length&&delete f[e],l--,!0):!1},s.clear=function(e){0===arguments.length?f={}:delete f[e]},s.abort=function(e){if(0===arguments.length){for(var t in f)if(f.hasOwnProperty(t)){var n=f[t];r(n)}return void r(n)}var n=f[e];null!=n&&r(n)},s.promisify=function(e){for(var r in d)if(d.hasOwnProperty(r)){var t=d[r];if(t.canWrap(e)){var n=t.wrap(e);return n}}return e},s}e("../jqr/npo");var t=e("./jqxhrWrapper"),n=e("./xhrWrapper"),o=e("./deferredPromiseWrapper"),i=e("../jqr/jqutils");return r}),define("utils/at/simpleAjaxTracker",["require"],function(e){var r={};return r.create=function(e,r){var t={add:function(t,n){e.add(r.target,t,n)},remove:function(t){e.remove(r.target,t)},abort:function(){e.abort(r.target)}};return t},r}),define("lifecycle/onInitHandler",["require","../utils/jqr/npo","../utils/utils","../utils/severity"],function(e){function r(e){var r=new Promise(function(o,i){if("function"!=typeof e.ctrl.onInit){var u=new Error("Controllers *must* implement an onInit method that returns either a Ractive function or a promise that resolves to a Ractive function!");return t.populateError(u,n.WARN,e),i(u),r}var a={ctrl:e.ctrl,route:e.route,routeParams:e.routeParams,args:e.args,ajaxTracker:e.ajaxTracker,prev:e.prev},s=e.ctrl.onInit(a);o(s)});return r}e("../utils/jqr/npo");var t=e("../utils/utils"),n=e("../utils/severity");return r}),define("lifecycle/onRemoveHandler",["require","../utils/utils","../utils/severity","../utils/jqr/npo"],function(e){function r(e){var r=new Promise(function(o,i){if("function"!=typeof e.ctrl.onRemove)return o(),r;var u={ctrl:e.ctrl,route:e.route,routeParams:e.routeParams,args:e.args,view:e.view,ajaxTracker:e.ajaxTracker,next:e.next},a=e.ctrl.onRemove(u);if(null==a||1==a)return o(),r;if(0==a){var s=new Error("controller onRemove() returned false, view will not be switched!");return t.populateError(s,n.INFO,e),i(s),r}if(t.isPromise(a))a.then(function(u){if(!e.mvc.requestTracker.active){var a=new Error("Request overwritten by another view request");return t.populateError(a,n.WARN,e),i(a),r}if(null==u||1==u)o();else{var a=new Error("controller onRemove() returned a promise that resolved to, '"+u+"', instead of 'true', view will not be switched!");t.populateError(a,n.INFO,e),i(a)}})["catch"](function(r){t.populateError(r,n.ERROR,e),i(r)});else{var s=new Error("Ignoring new view since onRemove did not return a valid response. onRemove must return either true/false or a promise that resolves to true/false.");t.populateError(s,n.WARN,e),i(s)}});return r}var t=e("../utils/utils"),n=e("../utils/severity");return e("../utils/jqr/npo"),r}),define("ractivelib/setupEvents",["require"],function(e){function r(e){if(e.view.off){e.view.off("complete"),e.view.off("render"),e.view.off("unrender"),e.view.off("teardown"),e.view.on("complete",function(){}),e.view.on("render",function(){}),e.view.on("unrender",function(){}),e.view.on("teardown",function(){});var r={};return r}}return r}),define("ractivelib/setupDefaultEvents",["require","ractive"],function(e){function r(e){t.defaults.onconstruct=function(){};var r={};return r}var t=e("ractive");return r}),define("utils/jqr/fade",["require"],function(e){function r(){function e(e){return"number"!=typeof e&&(e=e in t?t[e]:t["default"]),e}var r={},t={slow:600,fast:200,"default":400},n=!1,o=[];return r.off=function(e){n=e},r.stop=function(){o.forEach(function(e,r){e.fadeIn?e.el.style.opacity=1:e.el.style.opacity=0,null!=e.timeoutId&&clearTimeout(e.timeoutId),null!=e.requestId&&cancelAnimationFrame(e.requestId),null!=e.cb&&(e.cb(),e.cb=null)}),o=[]},r.queue=function(){return o},r.dequeue=function(e){for(var r=o.length-1;r>=0;){if(o[r]===e){o.splice(r,1);break}r--}},r.fadeIn=function(t,i,u){if("function"==typeof i&&(u=i,i={}),i=i||{},n||0==i.duration)return t.style.opacity=1,void(u&&u());i.duration=e(i.duration);var a={fadeIn:!0,el:t,cb:u,requestId:null,timeoutId:null};o.push(a);var s=window.getComputedStyle(t).getPropertyValue("opacity");t.style.opacity=+s;var c=+new Date,l=function(){var e=(new Date-c)/i.duration,n=+t.style.opacity+e;t.style.opacity=n,c=+new Date,+t.style.opacity<1?window.requestAnimationFrame?a.requestId=requestAnimationFrame(l):a.timeoutId=setTimeout(l,16):(r.dequeue(a),a.cb&&u())};l()},r.fadeOut=function(t,i,u){if("function"==typeof i&&(u=i,i={}),i=i||{},n||0==i.duration)return t.style.opacity=0,void(u&&u());i.duration=e(i.duration);var a={fadeIn:!1,el:t,cb:u,requestId:null,timeoutId:null};o.push(a);var s=window.getComputedStyle(t).getPropertyValue("opacity");t.style.opacity=+s;var c=+new Date,l=function(){var e=(new Date-c)/i.duration,n=+t.style.opacity-e;t.style.opacity=n,c=+new Date,+t.style.opacity>0?window.requestAnimationFrame?a.requestId=requestAnimationFrame(l):a.timeoutId=setTimeout(l,16):(r.dequeue(a),a.cb&&u())};l()},r}var r=r();return r}),define("transition/fade",["require","../utils/jqr/fade"],function(e){function r(){var e={};return e.intro=function(e,r){var n=e.target;if(null==n)throw new Error("options.target is not defined!");var o=e.duration||"fast";e.firstView&&(o=0);var i=document.querySelector(e.target);t.fadeIn(i,{duration:o},function(){r()})},e.outro=function(e,r){var n=e.target;if(null==n)throw new Error("options.target is not defined!");var o=e.duration||"fast";e.firstView&&(o=0);var i=document.querySelector(e.target);t.fadeOut(i,{duration:o},function(){r()})},e}var t=e("../utils/jqr/fade");return r()}),define("transition/intro",["require","../utils/jqr/npo","./fade"],function(e){function r(e){var r=new Promise(function(n,o){if(e.fx!==!0)return n(),r;var i=e.intro||t.intro;i(e,n)});return r}e("../utils/jqr/npo");var t=e("./fade");return r}),define("transition/outro",["require","../utils/jqr/npo","./fade"],function(e){function r(e){var r=new Promise(function(n,o){if(e.fx!==!0)return n(),r;var i=e.outro||t.outro;i(e,n)});return r}e("../utils/jqr/npo");var t=e("./fade");return r}),define("ractivelib/render/create",["require","../../utils/jqr/npo","../../utils/utils","../../utils/jqr/jqutils","../../utils/severity","../../router/router"],function(e){function r(e){var r=new Promise(function(u,a){if(null==e.viewOrPromise){i.restorePreviousHash();var s=new Error("Ignoring view since onInit returned null. onInit must return either a Ractive function or a promise that resolves to a Ractive function.");return t.populateError(s,o.WARN,e),a(s),r}if(t.isPromise(e.viewOrPromise))e.viewOrPromise.then(function(n){if("function"==typeof n&&(n=new n),!e.mvc.requestTracker.active){var i=new Error("Request overwritten by another view request");return t.populateError(i,o.WARN,e),a(i),r}var s=n;u(s)})["catch"](function(r){if(e.mvc.requestTracker.active||0!==arguments.length)t.populateError(n,o.ERROR,e),a(r);else{var n=new Error("Request overwritten by another view request");t.populateError(n,o.WARN,e),n.origError=r,a(n)}});else if(n.isFunction(e.viewOrPromise)){var c=new e.viewOrPromise;u(c)}else if(t.isRactiveObject(e.viewOrPromise)){var c=e.viewOrPromise;u(c)}else{var s=new Error("Ignoring view since onInit did not return a valid response. onInit must return either a Ractive function or a promise that resolves to a Ractive function.");t.populateError(s,o.WARN,e),a(s)}});return r}e("../../utils/jqr/npo");var t=e("../../utils/utils"),n=e("../../utils/jqr/jqutils"),o=e("../../utils/severity"),i=e("../../router/router");return r}),define("ractivelib/render/render",["require","../../utils/jqr/npo","../../utils/utils","../../utils/severity"],function(e){function r(e){var r=new Promise(function(r,o){var i=e.view.render(e.target);i.then(function(){r(e.view)})["catch"](function(r){t.populateError(r,n.ERROR,e),o(r)})});return r}e("../../utils/jqr/npo");var t=e("../../utils/utils"),n=e("../../utils/severity");return r}),define("ractivelib/render/unrender",["require","../../utils/jqr/npo","../../utils/utils","../../utils/severity"],function(e){function r(e){var r=new Promise(function(r,o){e.forceUnrender=function(){r(e.view)},e.mvc.view.unrender().then(function(){r(e.view)})["catch"](function(r){t.populateError(r,n.ERROR,e),o(r)})});return r}e("../../utils/jqr/npo");var t=e("../../utils/utils"),n=e("../../utils/severity");return r}),define("ractivelib/RactiveViewFactory",["require","./render/create","./render/render","./render/unrender"],function(e){function r(){var e={};return e.createView=function(e){return t(e)},e.renderView=function(e){return n(e)},e.unrenderView=function(e){return o(e)},e}var t=e("./render/create"),n=e("./render/render"),o=e("./render/unrender");return new r}),function(){"use strict";function e(){}function r(e,r){for(var t=e.length;t--;)if(e[t].listener===r)return t;return-1}function t(e){return function(){return this[e].apply(this,arguments)}}var n=e.prototype,o=this,i=o.EventEmitter;n.getListeners=function(e){var r,t,n=this._getEvents();if(e instanceof RegExp){r={};for(t in n)n.hasOwnProperty(t)&&e.test(t)&&(r[t]=n[t])}else r=n[e]||(n[e]=[]);return r},n.flattenListeners=function(e){var r,t=[];for(r=0;r<e.length;r+=1)t.push(e[r].listener);return t},n.getListenersAsObject=function(e){var r,t=this.getListeners(e);return t instanceof Array&&(r={},r[e]=t),r||t},n.addListener=function(e,t){var n,o=this.getListenersAsObject(e),i="object"==typeof t;for(n in o)o.hasOwnProperty(n)&&-1===r(o[n],t)&&o[n].push(i?t:{listener:t,once:!1});return this},n.on=t("addListener"),n.addOnceListener=function(e,r){return this.addListener(e,{listener:r,once:!0})},n.once=t("addOnceListener"),n.defineEvent=function(e){return this.getListeners(e),this},n.defineEvents=function(e){for(var r=0;r<e.length;r+=1)this.defineEvent(e[r]);return this},n.removeListener=function(e,t){if(null==t)return this.removeEvent(e);var n,o,i=this.getListenersAsObject(e);for(o in i)i.hasOwnProperty(o)&&(n=r(i[o],t),-1!==n&&i[o].splice(n,1));return this},n.off=t("removeListener"),n.addListeners=function(e,r){return this.manipulateListeners(!1,e,r)},n.removeListeners=function(e,r){return this.manipulateListeners(!0,e,r)},n.manipulateListeners=function(e,r,t){var n,o,i=e?this.removeListener:this.addListener,u=e?this.removeListeners:this.addListeners;if("object"!=typeof r||r instanceof RegExp)for(n=t.length;n--;)i.call(this,r,t[n]);else for(n in r)r.hasOwnProperty(n)&&(o=r[n])&&("function"==typeof o?i.call(this,n,o):u.call(this,n,o));return this},n.removeEvent=function(e){var r,t=typeof e,n=this._getEvents();if("string"===t)delete n[e];else if(e instanceof RegExp)for(r in n)n.hasOwnProperty(r)&&e.test(r)&&delete n[r];else delete this._events;return this},n.removeAllListeners=t("removeEvent"),n.emitEvent=function(e,r,t){var n,o,i,u,a,s=this.getListenersAsObject(r);for(u in s)if(s.hasOwnProperty(u))for(n=s[u].slice(0),i=n.length;i--;)o=n[i],o.once===!0&&this.removeListener(r,o.listener),a=o.listener.apply(e,t||[]),a===this._getOnceReturnValue()&&this.removeListener(r,o.listener);
return this},n.trigger=t("emitEvent"),n.emit=function(e,r){var t=Array.prototype.slice.call(arguments,2);return this.emitEvent(e,r,t)},n.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},n._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},n._getEvents=function(){return this._events||(this._events={})},e.noConflict=function(){return o.EventEmitter=i,e},"function"==typeof define&&define.amd?define("utils/jqr/EventEmitter",[],function(){return e}):"object"==typeof module&&module.exports?module.exports=e:o.EventEmitter=e}.call(this),define("kudu",["require","./router/router","./utils/jqr/npo","ractive","./utils/at/ajaxTracker","./utils/at/simpleAjaxTracker","./lifecycle/onInitHandler","./lifecycle/onRemoveHandler","./ractivelib/setupEvents","./ractivelib/setupDefaultEvents","./transition/intro","./transition/outro","./ractivelib/RactiveViewFactory","./utils/severity","./utils/utils","./utils/mode","./utils/jqr/jqutils","./utils/jqr/EventEmitter","./utils/jqr/fade"],function(e){function r(){function e(e){null==T.ctrl?r(e):y(e)}function r(e){E(e).then(function(){})["catch"](function(r){P(e),p.populateError(r,d.ERROR,e),O(e,r)})}function y(e){x(e).then(function(){E(e).then(function(){})["catch"](function(r){P(e),p.populateError(r,d.ERROR,e),O(e,r)})})["catch"](function(r){P(e),p.populateError(r,d.ERROR,e),O(e,r)})}function R(e){V.length>1&&(e.forceUnrender&&e.forceUnrender(),g.off(!0),g.stop(),A.enable=!1)}function E(e){var r=new Promise(function(r,t){var n={route:e.route,ctrl:e.ctrl,routeParams:e.routeParams,args:e.args,mvc:e.mvc,ajaxTracker:e.ajaxTracker,target:e.target,prev:{ajaxTracker:e.mvc.options.ajaxTracker,ctrl:e.mvc.ctrl,route:e.mvc.route,routeParams:e.mvc.options.routeParams,view:e.mvc.view,args:e.mvc.options.args}};k.triggerEvent("beforeInit",e),u(n).then(function(n){e.viewOrPromise=n,k.createView(e).then(function(n){e.view=n,e.kudu=k,k.triggerEvent("init",e),k.processNewView(e).then(function(e){q(),r()})["catch"](function(r){q(),p.populateError(r,d.ERROR,e),t(r)})})["catch"](function(r){q(),p.populateError(r,d.ERROR,e),t(r)})})["catch"](function(r){q(),p.populateError(r,d.ERROR,e),t(r)})});return r}function x(e){var r=new Promise(function(r,t){var n={next:{ctrl:e.ctrl,route:e.route,view:e.view,args:e.args,routeParams:e.routeParams,ajaxTracker:e.ajaxTracker},ctrl:T.ctrl,route:T.route,view:T.view,routeParams:T.options.routeParams,args:T.options.args,mvc:e.mvc,ajaxTracker:T.options.ajaxTracker,target:T.options.target};a(n).then(function(){k.triggerEvent("remove",e),k.triggerEvent("beforeUnrender",e),r()})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})});return r}function q(){V.splice(0,1),0===V.length&&(A.enable=!1,A={enable:!0},j(A))}function j(e){setTimeout(function(){e.enable&&g.off(!1)},350)}function O(e,r){e.error=r,k.triggerEvent("fail",e),p.logError(r)}function P(e){e.mvc.requestTracker.active!==!1&&(e.mvc.requestTracker.active=!1,N.abort(e.target),N.clear(e.target))}function b(e,r){e._kudu_id||Object.defineProperty(e,"_kudu_id",{enumerable:!1,writable:!1,value:r})}var k=new w,_=k.emit,A={enable:!0},I={},T={view:null,ctrl:null,requestTracker:{active:!0},route:null,options:{routeParams:null,args:null,forceUnrender:null}},V=[],C={target:null,routes:null,defaultRoute:null,unknownRouteResolver:null,intro:null,outro:null,fx:!1,viewFactory:v,debug:!0},L={kudu:k,wrappers:{}},N=o(L);return k.init=function(e){if(null==e)throw new Error("kudu.init() requires options!");C=m.extend({},C,e),k.validateInitOptions(C),h.DEBUG=n.DEBUG=C.debug,t.on("routeload",function(e){null==k.getActiveRoute()?e.initialRoute=!0:e.initialRoute=!1,k.routeLoaded(e)}),c(e),t.init({routes:C.routes,defaultRoute:e.defaultRoute,unknownRouteResolver:e.unknownRouteResolver})},k.router=function(){return t},k.validateInitOptions=function(e){if(null==e.viewFactory)throw new Error("viewFactory cannot be null!");if(null==e.viewFactory.createView)throw new Error("viewFactory must provide a createView function!");if(null==e.viewFactory.renderView)throw new Error("viewFactory must provide a renderView function!");if(null==e.viewFactory.unrenderView)throw new Error("viewFactory must provide an unrenderView function!")},k.go=function(e){setTimeout(function(){t.go(e)})},k.getId=function(e){return null==e?null:e._kudu_id},k.getDefaultTarget=function(){return C.target},k.getActiveRoute=function(){return T.route},k.getActiveView=function(){return T.view},k.getActiveController=function(){return T.ctrl},k.getDefaultViewFactory=function(){return v},k.routeLoaded=function(r){try{V.push(1),r.target=r.target||C.target,r.routeParams=r.routeParams||{},r.args=r.args||{},r.ajaxTracker=i.create(N,r),r.mvc=m.extend({},T),P(r);var t={active:!0};T.requestTracker=t,r.mvc.requestTracker=t,R(I),I=r;var n=k.createController(r.module);r.ctrl=n,delete r.module,e(r)}catch(o){O(r,o)}},k.createController=function(e){if(e instanceof Function){var r=new e;return null==r._kudu_id&&b(r,e._kudu_id),r}return e},k.processNewView=function(e){var r=new Promise(function(r,t){s(e);var n;if(n=null!=e.route.enter||null!=T.route&&null!=T.route.leave?k.customRenderView:k.renderViewWithAnimation,n(e).then(function(){k.callViewEvent("onComplete",e),k.triggerEvent("complete",e),r(e.view)})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)}),!e.mvc.requestTracker.active){var o=new Error("Request overwritten by another view request");p.populateError(o,d.WARN,e),t(o)}});return r},k.callViewEvent=function(e,r){var t=r.ctrl;if("function"==typeof t[e]){var n={ajaxTracker:r.ajaxTracker,routeParams:r.routeParams,args:r.args,view:r.view,ctrl:r.ctrl,route:r.route},o={ajaxTracker:r.mvc.options.ajaxTracker,ctrl:r.mvc.ctrl,route:r.mvc.route,routeParams:r.mvc.options.routeParams,args:r.mvc.options.args,view:r.mvc.view},i={};"onUnrender"===e?(i=o,i.next=n):(i=n,i.prev=o),t[e](i)}},k.emit=function(e,r){if("string"==typeof e){var t=Array.prototype.slice.call(arguments);return t.unshift(this),_.apply(this,t)}_.apply(this,arguments)},k.triggerEvent=function(e,r){r=r||{},r.mvc=r.mvc||{};var t=null,n=(C.target===r.target,r.ctrl);null==n&&(n={});var o={ajaxTracker:r.ajaxTracker,routeParams:r.routeParams,args:r.args,view:r.view,ctrl:r.ctrl,route:r.route},i={ajaxTracker:r.mvc.options.ajaxTracker,ctrl:r.mvc.ctrl,route:r.mvc.route,routeParams:r.mvc.options.routeParams,args:r.mvc.options.args,view:r.mvc.view},u={};"remove"===e||"beforeUnrender"===e||"unrender"===e?(u=i,u.next=o,t=i.view):"fail"===e?(u=i,u.prev=m.extend({},i),u.next=o,u.error=r.error,t=i.view?i.view:o.view):(u=o,u.prev=i,t=o.view);var a="lc.";k.emit(t,a+e,u),r[e]&&r[e].call(t,u)},k.enter=function(e){e._origOptions&&(e=e._origOptions);var r=new Promise(function(r,t){var n={duration:"fast",target:e.target,intro:C.intro,fx:C.fx||!1};(e.fx===!0||e.fx===!1)&&(n.fx=e.fx),null==T.ctrl&&(n.firstView=!0),k.renderView(e).then(function(){e._origOptions&&(e=e._origOptions),l(n).then(function(){r(e.view)})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})});return r},k.leave=function(e){e._origOptions&&(e=e._origOptions);var r=new Promise(function(r,t){var n={duration:100,target:e.target,outro:C.outro,fx:C.fx||!1};(e.fx===!0||e.fx===!1)&&(n.fx=e.fx),null==T.ctrl&&(n.firstView=!0,n.duration=0),f(n).then(function(){if(!e.mvc.requestTracker.active){var n=new Error("Request overwritten by another view request");return p.populateError(n,d.WARN,e),void t(n)}k.unrenderView(e).then(function(){r(e.view)})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})});return r},k.renderViewWithAnimation=function(e){e._origOptions&&(e=e._origOptions);var r=new Promise(function(r,t){k.leave(e).then(function(){k.enter(e).then(function(){r(e.view)})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})});return r},k.customLeave=function(e){var r=new Promise(function(r,t){var n,o,i={ctrl:T.ctrl,view:T.view,route:T.route,target:e.target,_origOptions:e,next:{ctrl:e.ctrl,view:e.view,route:e.route}};null==e.mvc.view?(n=function(){},o=function(){}):(null!=T.route&&(n=T.route.leave,o=k.unrenderViewCleanup),null==n&&(n=k.leave,o=function(){},i=e));var u=n(i);null==u&&(u=p.noopPromise()),u.then(function(){if(o(e),!e.mvc.requestTracker.active){var n=new Error("Request overwritten by another view request");return p.populateError(n,d.WARN,e),void t(n)}r()})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})});return r},k.customEnter=function(e){var r=new Promise(function(r,t){var n={ctrl:e.ctrl,view:e.view,route:e.route,target:e.target,_origOptions:e,prev:{ctrl:T.ctrl,view:T.view,route:T.route}},o=e.route.enter,i=k.renderViewCleanup;null==o&&(o=k.enter,i=function(){},n=e);var u=o(n);null==u&&(u=p.noopPromise()),u.then(function(){i(e),r(e.view)})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})});return r},k.customRenderView=function(e){var r=new Promise(function(r,t){k.customLeave(e).then(function(){k.customEnter(e).then(function(){r(e.view)})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})});return r},k.createView=function(e){e._origOptions&&(e=e._origOptions);var r=C.viewFactory.createView(e);return r},k.renderView=function(e){e._origOptions&&(e=e._origOptions);var r=new Promise(function(r,t){var n=C.viewFactory.renderView(e);k.renderViewCleanup(e),n.then(function(){r(e.view)})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})});return r},k.renderViewCleanup=function(e){e._renderViewCleanupCalled||(e._renderViewCleanupCalled=!0,k.updateMVC(e),k.callViewEvent("onRender",e),k.triggerEvent("render",e))},k.unrenderView=function(e){e._origOptions&&(e=e._origOptions);var r=new Promise(function(r,t){if(null==e.mvc.view)r();else{var n=C.viewFactory.unrenderView(e);n.then(function(){if(k.unrenderViewCleanup(e),!e.mvc.requestTracker.active){var n=new Error("Request overwritten by another view request");return p.populateError(n,d.WARN,e),void t(n)}r(e.mvc.view)})["catch"](function(r){p.populateError(r,d.ERROR,e),t(r)})}});return r},k.unrenderViewCleanup=function(e){e._unrenderViewCleanupCalled||(e._unrenderViewCleanupCalled=!0,k.callViewEvent("onUnrender",e),k.triggerEvent("unrender",e))},k.updateMVC=function(e){T.view=e.view,T.ctrl=e.ctrl,T.options=e,T.route=e.route},k}var t=e("./router/router");e("./utils/jqr/npo");var n=e("ractive"),o=e("./utils/at/ajaxTracker"),i=e("./utils/at/simpleAjaxTracker"),u=e("./lifecycle/onInitHandler"),a=e("./lifecycle/onRemoveHandler"),s=e("./ractivelib/setupEvents"),c=e("./ractivelib/setupDefaultEvents"),l=e("./transition/intro"),f=e("./transition/outro"),v=e("./ractivelib/RactiveViewFactory"),d=e("./utils/severity"),p=e("./utils/utils"),h=e("./utils/mode"),m=e("./utils/jqr/jqutils"),w=e("./utils/jqr/EventEmitter"),g=e("./utils/jqr/fade"),y=r();return y});
//# sourceMappingURL=kudu.0.0.5.min.js.map